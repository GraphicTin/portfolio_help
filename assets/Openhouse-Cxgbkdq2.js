import{S as e,a as r,b as a,g as t,i as o,l as s,n,o as i,p as l,u}from"./index-ZjM0BFRb.js";import"./_plugin-vue_export-helper-QjhXK4YL.js";import{i as c,n as d,r as h,t as f}from"./Button-CZncuPbl.js";var p="https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec",w=t(null),v=t(!1),m=t(!1),g=t(null);function y(){const e=t("openhouse"),r=t("A1:B"),a=async()=>async function(e,r){if(!p.startsWith("http"))return void(g.value="Configuration Error: Script URL is invalid.");const a=`${p}?sheetName=${e}&area=${r}`;v.value=!0,g.value=null,w.value=null;try{const e=await fetch(a);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const r=await e.json();if(r.error)throw new Error(r.error);Array.isArray(r.data)&&r.data.length>0&&Array.isArray(r.data[0])?w.value=r:g.value="Data format invalid or empty sheet."}catch(t){console.error("Fetch error:",t),g.value=`Failed to fetch data: ${t.message}`}finally{v.value=!1}}(e.value,r.value);return{fetchedData:w,isLoading:v,isWriting:m,error:g,inputSheetName:e,inputAreaRange:r,read:a,write:async(r,t)=>{m.value=!0;const o=[[t]],s=await async function(e,r,a){if(!p.startsWith("http"))return g.value="Configuration Error: Script URL is invalid.",!1;const t=new URLSearchParams;t.append("sheetName",e),t.append("range",r),t.append("dataToSend",JSON.stringify(a));try{const e=await fetch(p,{method:"POST",body:t});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const r=await e.json();if(r.error)throw new Error(r.error);return console.log("Write Successful:",r.message),!0}catch(o){return console.error("Write error:",o),g.value=`Failed to write data: ${o.message}`,!1}}(e.value,r,o);return s&&await a(),m.value=!1,s}}}var S={__name:"Openhouse",setup(t){const p=y();return s(async()=>{await p.read(),await p.write("A4","INIT LOAD SUCCESS")?console.log("Successfully wrote data to A1 and refreshed the view."):console.error("Write failed. Check console and Apps Script logs.")}),(t,s)=>(u(),r(n,null,[i(h,{class:""},{default:l(()=>[i(f,{onClick:s[0]||(s[0]=e=>t.changeMode()),class:"flex h-full w-full rounded-t-none border-t-0"},{default:l(()=>[o("p",null,e(a(c)("theme"))+" mode ",1)]),_:1})]),_:1}),i(d)],64))}};export{S as default};