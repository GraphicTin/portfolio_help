import{a as t,i as e,n,o as i,s as o,t as a}from"./Spacer-CJNZoKQr.js";import{D as l,I as r,K as d,M as u,P as s,R as p,T as c,X as f,et as m,k as v,n as h,nt as g,z as x}from"./index-Cv2QkxD2.js";function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==b(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y={name:"InputText",extends:{name:"BaseInputText",extends:{name:"BaseInput",extends:{name:"BaseEditableHolder",extends:i,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:void 0!==this.defaultValue?this.defaultValue:this.modelValue}},watch:{modelValue:{deep:!0,handler:function(t){this.d_value=t}},defaultValue:function(t){this.d_value=t},$formName:{immediate:!0,handler:function(t){var e,n;this.formField=(null===(e=this.$pcForm)||void 0===e||null===(n=e.register)||void 0===n?void 0:n.call(e,t,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(t){var e,n;this.formField=(null===(e=this.$pcForm)||void 0===e||null===(n=e.register)||void 0===n?void 0:n.call(e,this.$formName,t))||{}}},$formDefaultValue:{immediate:!0,handler:function(t){this.d_value!==t&&(this.d_value=t)}},$formValue:{immediate:!1,handler:function(t){var e;null!==(e=this.$pcForm)&&void 0!==e&&e.getFieldState(this.$formName)&&t!==this.d_value&&(this.d_value=t)}}},formField:{},methods:{writeValue:function(t,e){var n,i;this.controlled&&(this.d_value=t,this.$emit("update:modelValue",t)),this.$emit("value-change",t),null===(n=(i=this.formField).onChange)||void 0===n||n.call(i,{originalEvent:e,value:t})},findNonEmpty:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.find(c)}},computed:{$filled:function(){return c(this.d_value)},$invalid:function(){var t,e;return!this.$formNovalidate&&this.findNonEmpty(this.invalid,null===(t=this.$pcFormField)||void 0===t||null===(t=t.$field)||void 0===t?void 0:t.invalid,null===(e=this.$pcForm)||void 0===e||null===(e=e.getFieldState(this.$formName))||void 0===e?void 0:e.invalid)},$formName:function(){var t;return this.$formNovalidate?void 0:this.name||(null===(t=this.$formControl)||void 0===t?void 0:t.name)},$formControl:function(){var t;return this.formControl||(null===(t=this.$pcFormField)||void 0===t?void 0:t.formControl)},$formNovalidate:function(){var t;return null===(t=this.$formControl)||void 0===t?void 0:t.novalidate},$formDefaultValue:function(){var t,e;return this.findNonEmpty(this.d_value,null===(t=this.$pcFormField)||void 0===t?void 0:t.initialValue,null===(e=this.$pcForm)||void 0===e||null===(e=e.initialValues)||void 0===e?void 0:e[this.$formName])},$formValue:function(){var t,e;return this.findNonEmpty(null===(t=this.$pcFormField)||void 0===t||null===(t=t.$field)||void 0===t?void 0:t.value,null===(e=this.$pcForm)||void 0===e||null===(e=e.getFieldState(this.$formName))||void 0===e?void 0:e.value)},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var t;return null!==(t=this.variant)&&void 0!==t?t:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var t;return null!==(t=this.fluid)&&void 0!==t?t:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},style:h.extend({name:"inputtext",style:"\n    .p-inputtext {\n        font-family: inherit;\n        font-feature-settings: inherit;\n        font-size: 1rem;\n        color: dt('inputtext.color');\n        background: dt('inputtext.background');\n        padding-block: dt('inputtext.padding.y');\n        padding-inline: dt('inputtext.padding.x');\n        border: 1px solid dt('inputtext.border.color');\n        transition:\n            background dt('inputtext.transition.duration'),\n            color dt('inputtext.transition.duration'),\n            border-color dt('inputtext.transition.duration'),\n            outline-color dt('inputtext.transition.duration'),\n            box-shadow dt('inputtext.transition.duration');\n        appearance: none;\n        border-radius: dt('inputtext.border.radius');\n        outline-color: transparent;\n        box-shadow: dt('inputtext.shadow');\n    }\n\n    .p-inputtext:enabled:hover {\n        border-color: dt('inputtext.hover.border.color');\n    }\n\n    .p-inputtext:enabled:focus {\n        border-color: dt('inputtext.focus.border.color');\n        box-shadow: dt('inputtext.focus.ring.shadow');\n        outline: dt('inputtext.focus.ring.width') dt('inputtext.focus.ring.style') dt('inputtext.focus.ring.color');\n        outline-offset: dt('inputtext.focus.ring.offset');\n    }\n\n    .p-inputtext.p-invalid {\n        border-color: dt('inputtext.invalid.border.color');\n    }\n\n    .p-inputtext.p-variant-filled {\n        background: dt('inputtext.filled.background');\n    }\n\n    .p-inputtext.p-variant-filled:enabled:hover {\n        background: dt('inputtext.filled.hover.background');\n    }\n\n    .p-inputtext.p-variant-filled:enabled:focus {\n        background: dt('inputtext.filled.focus.background');\n    }\n\n    .p-inputtext:disabled {\n        opacity: 1;\n        background: dt('inputtext.disabled.background');\n        color: dt('inputtext.disabled.color');\n    }\n\n    .p-inputtext::placeholder {\n        color: dt('inputtext.placeholder.color');\n    }\n\n    .p-inputtext.p-invalid::placeholder {\n        color: dt('inputtext.invalid.placeholder.color');\n    }\n\n    .p-inputtext-sm {\n        font-size: dt('inputtext.sm.font.size');\n        padding-block: dt('inputtext.sm.padding.y');\n        padding-inline: dt('inputtext.sm.padding.x');\n    }\n\n    .p-inputtext-lg {\n        font-size: dt('inputtext.lg.font.size');\n        padding-block: dt('inputtext.lg.padding.y');\n        padding-inline: dt('inputtext.lg.padding.x');\n    }\n\n    .p-inputtext-fluid {\n        width: 100%;\n    }\n",classes:{root:function(t){var e=t.instance,n=t.props;return["p-inputtext p-component",{"p-filled":e.$filled,"p-inputtext-sm p-inputfield-sm":"small"===n.size,"p-inputtext-lg p-inputfield-lg":"large"===n.size,"p-invalid":e.$invalid,"p-variant-filled":"filled"===e.$variant,"p-inputtext-fluid":e.$fluid}]}}}),provide:function(){return{$pcInputText:this,$parentInstance:this}}},inheritAttrs:!1,methods:{onInput:function(t){this.writeValue(t.target.value,t)}},computed:{attrs:function(){return r(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)},dataP:function(){return o($({invalid:this.$invalid,fluid:this.$fluid,filled:"filled"===this.$variant},this.size,this.size))}}},w=["value","name","disabled","aria-invalid","data-p"];y.render=function(t,e,n,i,o,a){return x(),u("input",r({type:"text",class:t.cx("root"),value:t.d_value,name:t.name,disabled:t.disabled,"aria-invalid":t.$invalid||void 0,"data-p":a.dataP,onInput:e[0]||(e[0]=function(){return a.onInput&&a.onInput.apply(a,arguments)})},a.attrs),null,16,w)};var V="https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec",F=f(null),S=f(!1),k=f(!1),N=f(null);function P(){const t=f("openhouse"),e=f("A1:B"),n=async()=>async function(t,e){if(!V.startsWith("http"))return void(N.value="Configuration Error: Script URL is invalid.");const n=`${V}?sheetName=${t}&area=${e}`;S.value=!0,N.value=null,F.value=null;try{const t=await fetch(n);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const e=await t.json();if(e.error)throw new Error(e.error);Array.isArray(e.data)&&e.data.length>0&&Array.isArray(e.data[0])?F.value=e:N.value="Data format invalid or empty sheet."}catch(i){console.error("Fetch error:",i),N.value=`Failed to fetch data: ${i.message}`}finally{S.value=!1}}(t.value,e.value);return{fetchedData:F,isLoading:S,isWriting:k,error:N,inputSheetName:t,inputAreaRange:e,read:n,write:async(e,i)=>{k.value=!0;const o=[[i]],a=await async function(t,e,n){if(!V.startsWith("http"))return N.value="Configuration Error: Script URL is invalid.",!1;const i=new URLSearchParams;i.append("sheetName",t),i.append("range",e),i.append("dataToSend",JSON.stringify(n));try{const t=await fetch(V,{method:"POST",body:i});if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const e=await t.json();if(e.error)throw new Error(e.error);return console.log("Write Successful:",e.message),!0}catch(o){return console.error("Write error:",o),N.value=`Failed to write data: ${o.message}`,!1}}(t.value,e,o);return a&&await n(),k.value=!1,a}}}var A={class:"bg-indigo-100 dark:bg-indigo-900 p-6 rounded-lg shadow-xl mt-8"},C={class:"flex flex-wrap gap-4 items-end"},E={class:"flex flex-col grow min-w-32"},_={class:"flex flex-col grow min-w-48"},z={__name:"Openhouse",setup(i){const o=P();return p(async()=>{await o.read(),await o.write("A4","INIT LOAD SUCCESS")?console.log("Successfully wrote data to A1 and refreshed the view."):console.error("Write failed. Check console and Apps Script logs.")}),(i,o)=>(x(),u(l,null,[s(n,{class:""},{default:d(()=>[s(m(t),{onClick:o[0]||(o[0]=t=>i.changeMode()),class:"flex h-full w-full rounded-t-none border-t-0"},{default:d(()=>[v("p",null,g(m(e)("theme"))+" mode ",1)]),_:1})]),_:1}),s(a),v("div",A,[o[6]||(o[6]=v("h3",{class:"text-xl font-bold mb-4 dark:text-gray-100"}," Write Data Back to Sheet (POST) ",-1)),v("div",C,[v("div",E,[o[4]||(o[4]=v("label",{class:"text-sm font-medium mb-1 dark:text-gray-300"},"Target Cell/Range",-1)),s(m(y),{modelValue:i.writeRange,"onUpdate:modelValue":o[1]||(o[1]=t=>i.writeRange=t),placeholder:"e.g., A5"},null,8,["modelValue"])]),v("div",_,[o[5]||(o[5]=v("label",{class:"text-sm font-medium mb-1 dark:text-gray-300"},"Value to Write",-1)),s(m(y),{modelValue:i.writeValue,"onUpdate:modelValue":o[2]||(o[2]=t=>i.writeValue=t),placeholder:"Enter new content..."},null,8,["modelValue"])]),s(m(t),{onClick:o[3]||(o[3]=t=>i.handleWrite()),disabled:i.isWriting||!i.writeRange||!i.writeValue,class:"p-button-secondary h-10 w-full md:w-auto",label:i.isWriting?"Writing...":"Write Value"},null,8,["disabled","label"])])])],64))}};export{z as default};