import{a as e,c as t,d as n,f as r,h as i,l as a,m as o,n as s,o as c,p as l,r as u,s as d,t as f,u as p}from"./index-BeLSMPlN.js";var m=`https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec`,h=l(null),g=l(!1),_=l(!1),v=l(null);async function y(e,t){if(!m.startsWith(`http`)){v.value=`Configuration Error: Script URL is invalid.`;return}let n=`${m}?sheetName=${e}&area=${t}`;g.value=!0,v.value=null,h.value=null;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);Array.isArray(t.data)&&t.data.length>0&&Array.isArray(t.data[0])?h.value=t:v.value=`Data format invalid or empty sheet.`}catch(e){console.error(`Fetch error:`,e),v.value=`Failed to fetch data: ${e.message}`}finally{g.value=!1}}async function b(e,t,n){if(!m.startsWith(`http`))return v.value=`Configuration Error: Script URL is invalid.`,!1;let r=new URLSearchParams;r.append(`sheetName`,e),r.append(`range`,t),r.append(`dataToSend`,JSON.stringify(n));try{let e=await fetch(m,{method:`POST`,body:r});if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);return console.log(`Write Successful:`,t.message),!0}catch(e){return console.error(`Write error:`,e),v.value=`Failed to write data: ${e.message}`,!1}}function x(){let e=l(`openhouse`),t=l(`A1:B`),n=async()=>y(e.value,t.value);return{fetchedData:h,isLoading:g,isWriting:_,error:v,inputSheetName:e,inputAreaRange:t,read:n,write:async(t,r)=>{_.value=!0;let i=[[r]],a=await b(e.value,t,i);return a&&await n(),_.value=!1,a}}}var S={__name:`Openhouse`,setup(l){let m=x();return p(async()=>{await m.read(),await m.write(`A4`,`INIT LOAD SUCCESS`)?console.log(`Successfully wrote data to A1 and refreshed the view.`):console.error(`Write failed. Check console and Apps Script logs.`)}),(l,p)=>(n(),t(c,null,[a(u,{class:``},{default:r(()=>[a(f,{onClick:p[0]||=e=>l.changeMode(),class:`flex h-full w-full rounded-t-none border-t-0`},{default:r(()=>[d(`p`,null,i(o(e)(`theme`))+` mode `,1)]),_:1})]),_:1}),a(s)],64))}};export{S as default};