import{$ as e,B as t,H as n,N as r,O as i,P as a,X as o,Z as s,j as c,q as l,w as u}from"./vendor-DBpJo2Ic.js";import{r as d}from"./vendor-ui-B6oc3jNg.js";import{a as f,i as p,t as m}from"./index-PbqiE6VS.js";var h=`https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec`,g=o(null),_=o(!1),v=o(!1),y=o(null);async function b(e,t){if(!h.startsWith(`http`)){y.value=`Configuration Error: Script URL is invalid.`;return}let n=`${h}?sheetName=${e}&area=${t}`;_.value=!0,y.value=null,g.value=null;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);Array.isArray(t.data)&&t.data.length>0&&Array.isArray(t.data[0])?g.value=t:y.value=`Data format invalid or empty sheet.`}catch(e){console.error(`Fetch error:`,e),y.value=`Failed to fetch data: ${e.message}`}finally{_.value=!1}}async function x(e,t,n){if(!h.startsWith(`http`))return y.value=`Configuration Error: Script URL is invalid.`,!1;let r=new URLSearchParams;r.append(`sheetName`,e),r.append(`range`,t),r.append(`dataToSend`,JSON.stringify(n));try{let e=await fetch(h,{method:`POST`,body:r});if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);return console.log(`Write Successful:`,t.message),!0}catch(e){return console.error(`Write error:`,e),y.value=`Failed to write data: ${e.message}`,!1}}function S(){let e=o(`openhouse`),t=o(`A1:B`),n=async()=>b(e.value,t.value);return{fetchedData:g,isLoading:_,isWriting:v,error:y,inputSheetName:e,inputAreaRange:t,read:n,write:async(t,r)=>{v.value=!0;let i=[[r]],a=await x(e.value,t,i);return a&&await n(),v.value=!1,a}}}var C={class:`bg-indigo-100 dark:bg-indigo-900 p-6 rounded-lg shadow-xl mt-8`},w={class:`flex flex-wrap gap-4 items-end`},T={class:`flex flex-col grow min-w-32`},E={class:`flex flex-col grow min-w-48`},D={__name:`Openhouse`,setup(o){let h=S();return t(async()=>{await h.read(),await h.write(`A4`,`INIT LOAD SUCCESS`)?console.log(`Successfully wrote data to A1 and refreshed the view.`):console.error(`Write failed. Check console and Apps Script logs.`)}),(t,o)=>(n(),r(i,null,[a(f,{class:``},{default:l(()=>[a(m,{onClick:o[0]||=e=>t.changeMode(),class:`flex h-full w-full rounded-t-none border-t-0`},{default:l(()=>[c(`p`,null,e(s(u)(`theme`))+` mode `,1)]),_:1})]),_:1}),a(p),c(`div`,C,[o[6]||=c(`h3`,{class:`text-xl font-bold mb-4 dark:text-gray-100`},` Write Data Back to Sheet (POST) `,-1),c(`div`,w,[c(`div`,T,[o[4]||=c(`label`,{class:`text-sm font-medium mb-1 dark:text-gray-300`},`Target Cell/Range`,-1),a(s(d),{modelValue:t.writeRange,"onUpdate:modelValue":o[1]||=e=>t.writeRange=e,placeholder:`e.g., A5`},null,8,[`modelValue`])]),c(`div`,E,[o[5]||=c(`label`,{class:`text-sm font-medium mb-1 dark:text-gray-300`},`Value to Write`,-1),a(s(d),{modelValue:t.writeValue,"onUpdate:modelValue":o[2]||=e=>t.writeValue=e,placeholder:`Enter new content...`},null,8,[`modelValue`])]),a(m,{onClick:o[3]||=e=>t.handleWrite(),disabled:t.isWriting||!t.writeRange||!t.writeValue,class:`p-button-secondary h-10 w-full md:w-auto`,label:t.isWriting?`Writing...`:`Write Value`},null,8,[`disabled`,`label`])])])],64))}};export{D as default};