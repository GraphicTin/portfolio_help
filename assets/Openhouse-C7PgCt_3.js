import{S as e,a as t,b as n,g as r,i,l as a,n as o,o as s,p as c,u as l}from"./index-CdE6SpTn.js";import"./_plugin-vue_export-helper-CS_Jz9bW.js";import{i as u,n as d,r as f,t as p}from"./Button-BVmG4UX-.js";var m=`https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec`,h=r(null),g=r(!1),_=r(!1),v=r(null);async function y(e,t){if(!m.startsWith(`http`)){v.value=`Configuration Error: Script URL is invalid.`;return}let n=`${m}?sheetName=${e}&area=${t}`;g.value=!0,v.value=null,h.value=null;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);Array.isArray(t.data)&&t.data.length>0&&Array.isArray(t.data[0])?h.value=t:v.value=`Data format invalid or empty sheet.`}catch(e){console.error(`Fetch error:`,e),v.value=`Failed to fetch data: ${e.message}`}finally{g.value=!1}}async function b(e,t,n){if(!m.startsWith(`http`))return v.value=`Configuration Error: Script URL is invalid.`,!1;let r=new URLSearchParams;r.append(`sheetName`,e),r.append(`range`,t),r.append(`dataToSend`,JSON.stringify(n));try{let e=await fetch(m,{method:`POST`,body:r});if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);return console.log(`Write Successful:`,t.message),!0}catch(e){return console.error(`Write error:`,e),v.value=`Failed to write data: ${e.message}`,!1}}function x(){let e=r(`openhouse`),t=r(`A1:B`),n=async()=>y(e.value,t.value);return{fetchedData:h,isLoading:g,isWriting:_,error:v,inputSheetName:e,inputAreaRange:t,read:n,write:async(t,r)=>{_.value=!0;let i=[[r]],a=await b(e.value,t,i);return a&&await n(),_.value=!1,a}}}var S={__name:`Openhouse`,setup(r){let m=x();return a(async()=>{await m.read(),await m.write(`A4`,`INIT LOAD SUCCESS`)?console.log(`Successfully wrote data to A1 and refreshed the view.`):console.error(`Write failed. Check console and Apps Script logs.`)}),(r,a)=>(l(),t(o,null,[s(f,{class:``},{default:c(()=>[s(p,{onClick:a[0]||=e=>r.changeMode(),class:`flex h-full w-full rounded-t-none border-t-0`},{default:c(()=>[i(`p`,null,e(n(u)(`theme`))+` mode `,1)]),_:1})]),_:1}),s(d)],64))}};export{S as default};