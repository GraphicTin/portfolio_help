import{C as e,_ as t,a as n,d as r,m as i,o as a,r as o,s,u as c,x as l}from"./index-TvshT_9r.js";import"./_plugin-vue_export-helper-9n1O4nl6.js";import{i as u,n as d,r as f,t as p}from"./Button-B9rInnTS.js";var m=`https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec`,h=t(null),g=t(!1),_=t(!1),v=t(null);async function y(e,t){if(!m.startsWith(`http`)){v.value=`Configuration Error: Script URL is invalid.`;return}let n=`${m}?sheetName=${e}&area=${t}`;g.value=!0,v.value=null,h.value=null;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);Array.isArray(t.data)&&t.data.length>0&&Array.isArray(t.data[0])?h.value=t:v.value=`Data format invalid or empty sheet.`}catch(e){console.error(`Fetch error:`,e),v.value=`Failed to fetch data: ${e.message}`}finally{g.value=!1}}async function b(e,t,n){if(!m.startsWith(`http`))return v.value=`Configuration Error: Script URL is invalid.`,!1;let r=new URLSearchParams;r.append(`sheetName`,e),r.append(`range`,t),r.append(`dataToSend`,JSON.stringify(n));try{let e=await fetch(m,{method:`POST`,body:r});if(!e.ok)throw Error(`HTTP error! Status: ${e.status}`);let t=await e.json();if(t.error)throw Error(t.error);return console.log(`Write Successful:`,t.message),!0}catch(e){return console.error(`Write error:`,e),v.value=`Failed to write data: ${e.message}`,!1}}function x(){let e=t(`openhouse`),n=t(`A1:B`),r=async()=>y(e.value,n.value);return{fetchedData:h,isLoading:g,isWriting:_,error:v,inputSheetName:e,inputAreaRange:n,read:r,write:async(t,n)=>{_.value=!0;let i=[[n]],a=await b(e.value,t,i);return a&&await r(),_.value=!1,a}}}var S={__name:`Openhouse`,setup(t){let m=x();return c(async()=>{await m.read(),await m.write(`A4`,`INIT LOAD SUCCESS`)?console.log(`Successfully wrote data to A1 and refreshed the view.`):console.error(`Write failed. Check console and Apps Script logs.`)}),(t,c)=>(r(),a(o,null,[s(f,{class:``},{default:i(()=>[s(p,{onClick:c[0]||=e=>t.changeMode(),class:`flex h-full w-full rounded-t-none border-t-0`},{default:i(()=>[n(`p`,null,e(l(u)(`theme`))+` mode `,1)]),_:1})]),_:1}),s(d)],64))}};export{S as default};