import{_ as e,a,b as t,c as r,d as l,f as o,g as s,h as n,i,l as d,m as u,p as c,u as f,v as w,y as h}from"./index-BDYRx--b.js";var m="https://script.google.com/macros/s/AKfycbzKZDhdWzD2vqwbUdnPMwlEjfePy_tFpjWzmlmV6AiTzx4dooDZBAwxlIxgAALj-torZQ/exec",g=w(null),p=w(!1),v=w(!1),y=w(null);function x(){const e=w("openhouse"),a=w("A1:B"),t=async()=>async function(e,a){if(!m.startsWith("http"))return void(y.value="Configuration Error: Script URL is invalid.");const t=`${m}?sheetName=${e}&area=${a}`;p.value=!0,y.value=null,g.value=null;try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const a=await e.json();if(a.error)throw new Error(a.error);Array.isArray(a.data)&&a.data.length>0&&Array.isArray(a.data[0])?g.value=a:y.value="Data format invalid or empty sheet."}catch(r){console.error("Fetch error:",r),y.value=`Failed to fetch data: ${r.message}`}finally{p.value=!1}}(e.value,a.value);return{fetchedData:g,isLoading:p,isWriting:v,error:y,inputSheetName:e,inputAreaRange:a,read:t,write:async(a,r)=>{v.value=!0;const l=[[r]],o=await async function(e,a,t){if(!m.startsWith("http"))return y.value="Configuration Error: Script URL is invalid.",!1;const r=new URLSearchParams;r.append("sheetName",e),r.append("range",a),r.append("dataToSend",JSON.stringify(t));try{const e=await fetch(m,{method:"POST",body:r});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const a=await e.json();if(a.error)throw new Error(a.error);return console.log("Write Successful:",a.message),!0}catch(l){return console.error("Write error:",l),y.value=`Failed to write data: ${l.message}`,!1}}(e.value,a,l);return o&&await t(),v.value=!1,o}}}var b={class:"bg-indigo-100 dark:bg-indigo-900 p-6 rounded-lg shadow-xl mt-8"},S={class:"flex flex-wrap gap-4 items-end"},A={class:"flex flex-col grow min-w-32"},W={class:"flex flex-col grow min-w-48"},V={__name:"Openhouse",setup(w){const m=x();return n(async()=>{await m.read(),await m.write("A4","INIT LOAD SUCCESS")?console.log("Successfully wrote data to A1 and refreshed the view."):console.error("Write failed. Check console and Apps Script logs.")}),(n,w)=>(s(),c(l,null,[u(a,{class:""},{default:e(()=>[u(h(f),{onClick:w[0]||(w[0]=e=>n.changeMode()),class:"flex h-full w-full rounded-t-none border-t-0"},{default:e(()=>[o("p",null,t(h(r)("theme"))+" mode ",1)]),_:1})]),_:1}),u(i),o("div",b,[w[6]||(w[6]=o("h3",{class:"text-xl font-bold mb-4 dark:text-gray-100"}," Write Data Back to Sheet (POST) ",-1)),o("div",S,[o("div",A,[w[4]||(w[4]=o("label",{class:"text-sm font-medium mb-1 dark:text-gray-300"},"Target Cell/Range",-1)),u(h(d),{modelValue:n.writeRange,"onUpdate:modelValue":w[1]||(w[1]=e=>n.writeRange=e),placeholder:"e.g., A5"},null,8,["modelValue"])]),o("div",W,[w[5]||(w[5]=o("label",{class:"text-sm font-medium mb-1 dark:text-gray-300"},"Value to Write",-1)),u(h(d),{modelValue:n.writeValue,"onUpdate:modelValue":w[2]||(w[2]=e=>n.writeValue=e),placeholder:"Enter new content..."},null,8,["modelValue"])]),u(h(f),{onClick:w[3]||(w[3]=e=>n.handleWrite()),disabled:n.isWriting||!n.writeRange||!n.writeValue,class:"p-button-secondary h-10 w-full md:w-auto",label:n.isWriting?"Writing...":"Write Value"},null,8,["disabled","label"])])])],64))}};export{V as default};